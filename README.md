# Technical Report: Engineering Features for the Unsupervised Classification of IoT devices based on MAP/GTP Signaling Traffic

This additional material should be seen as accompanying material to the paper **Untangling IoT Global Connectivity: The Importance of Mobile Signaling Traffic**, published in IEEE Transactions on Network and Service Management.

# Introduction

The classification and clustering of IoT devices based on limited information is a crucial problem for operators. The signaling behavior, and hence the resulting load on mobile core components, is a highly relevant characteristic for multiple stakeholders in the M2M-focused mobile operator landscape. In the accompanying paper [ADD REF], we investigate overall characteristics of the aggregated traffic in M2M environments on basis of two independent, large scale datasets. Further, we identify an extensive feature set and show its application in unsupervised machine learning to identify and cluster similar devices. In this technical report, we provide a detailed description of the complete feature set including examples to highlight the rationale behind why features are designed the way they are. We outline technical limitations due to the size of the datasets, abstractions and assumptions that went into defining the features and provide examples where needed to understand the features.

# Feature Set Overview

We contribute an extensive feature set that describes the behavior of single devices, which we obtain by analyzing the combined MAP and GTPv1 signaling traffic of each device. 
In total, the feature set includes 198 features, which contain information regarding overall statistics, device activity, used message types and signaling patterns, mobility statistics and process statistics. 
In the following, we outline each feature group and highlight their respective differentiation possibility. Note that not all features covered here are also covered in the referenced paper to keep the content concise. Additionally, some features are included in the table presented below that have not been used during the clustering performed on the paper. Instead, feature thinning based on expert knowledge has been done to obtain a reduced feature set for the paper.

## Overall Statistics

The features we include in this category capture the general signaling behavior of the IoT devices, and include the overall number of signaling dialogues as well as the number of MAP and GTP dialogs, respectively. 
Further, we also account for the number of successful interactions as well as counts for erroneous or rejected dialogues. 
Errors indicate technical inconsistencies such as missing replies, out of order packets, invalid packet contents. 
Rejects represent actively rejected signaling requests, and do not indicate faulty behavior by devices, carriers or the core network. These occur if devices try to roam using visited network operators that are disallowed based on missing roaming agreements or policy. Devices deployed with either no longer or not yet activated SIM cards also get denied by the home network and hence result in reject dialogs.

The goal of the overall statistics is to provide general information about IoT devices, and to enable the differentiation of devices that rely on circuit switched connectivity from devices that use data connectivity. Further, they allow the identification of the devices that contribute a significant amount of signaling traffic. Finally, the error and reject features enable us to identify anomalous and misconfigured devices that fail to complete successful signaling.

## Message Type and Session Statistics

Next, we evaluate which type of signaling procedures the IoT devices trigger, and their respective temporal sequence. 
We create features to indicate what fraction of the signaling traffic corresponds to each of the following MAP dialogues: sendAuthenticationInfo (SAI), updateLocation (UL), updateGPRSLocation (UL\_GPRS) as well as the GTP-related create, update and delete messages. We also differentiate between successful, erroneous and rejected dialogues, similar to the above overall statistics.

In addition, we investigate the sequence of dialogues in time. 
We assemble messages occurring in close proximity to each other into _sessions_ that capture and can further explain these sequences of signaling dialogues. 
These sessions capture the activity of the devices corresponding to specific network activity (e.g., a smart meter uploading hourly measurements to the application server, or a connected car providing navigation instructions to the driver).
We then compute features that indicate the number of unique dialogue sequences required to describe 90\% and 99\% of the sessions we derive for each IoT device.

These features allow further differentiation regarding both devices' overall signaling behavior with respect to which signaling messages are used and how variable the signaling patterns of each device are by evaluating the number of uniquely observed signaling sessions.

## Device Activity

In this set, we propose features that capture the activity level of devices, both when idle or with an active data connection. 
We include here two metrics: the overall time in minutes between the first and last signaling dialogue observed in each of the datasets, and the number of minutes with actual signaling activity (i.e., one signaling dialogue occurs in that respective one minute slot) for both MAP and GTP. 
% In a discrete timeseries with time-slots of one minute duration, we consider a device to be "active" during a time-slot if at least one signaling dialogue occurs during that time-slot. 
For GTP, we only consider slots with GTP-specific dialogues. 
We compute the relative activity (for both MAP and GTP) as the ratio between the total time in minutes between first and last signaling dialogue, and the number of active time-slots (i.e., minutes with signaling activity).

These features act as an indicator for the activity of devices on the radio network. 
They further allow the differentiation between long-running devices that generate traffic continuously, and devices with spurious activity that only trigger signaling traffic occasionally.

## Mobility Statistics

In order to characterize the mobility of IoT devices, we introduce features that capture the number of unique visited networks the IoT devices use, and the number of times the devices switch between using a specific mobile network entities (i.e., radio cells,VLR, visited MNO, SGSN in the visited MNO). 
These include the country a device is located in and the operator it is roaming with, the VLR and SGSN of the visited network communicating with the home network and the cell GTP messages are originating from. 
For all of these features we compute the total number each value changes as well as the number of uniquely observed values.

These features allow us to differentiate between stationary devices that exhibit a low number of changes in mobility related values, and mobile devices that exhibit many changes. Additionally, we can distinguish devices that alternate between few operators (e.g., due to coverage issues) from devices that visit many different operators, indicating higher mobility.

## Longitudinal Activity Statistics

The last set of quantitative features encompasses information regarding various stochastic processes such as the interarrival times of sessions. 
Specifically, we compute the mean and standard deviation for each of the following features:
- Interarrival times between sessions: we define separate features for the time between sessions containing GTP dialogs, sessions containing only MAP dialogues, and any two consecutive sessions, irrespective of session content.
- Interarrival time values between dialogues within sessions, and separately between GTP update messages. 
- Context duration, meaning the time between PDP tunnel creation and its deletion.

These features allow us to identify the devices that exhibit low variability between signaling interactions, indicating periodic behavior. Furthermore, the context duration enables us to separate the devices that establish many short-lived data tunnels from the ones that establish few long-lasting tunnels.

## Device Information

Finally, each device is annotated with a set of meta-information. This includes a unique identifier, which customer a device belongs to and mappings for a public [GSMA IMEI database](https://imeidb.gsma.com/imei/index). These features provide more general information and enable the lookup of modem designations and manufacturers as well as provide superficial information on the feature set of devices, e.g. if a modem supports LTE or is only 2G/3G capable. Note that these fields are not used for clustering and are only included for completeness's sake.

# Feature Description

After outlining the general idea behind the feature set, we introduce all the features and provide additional information where needed. Furthermore, we highlight which features were used during the clustering performed for the referenced paper.

Man features are also annotated with a link to additional information providing a short summary of relevant background information. These include the definitions of successful, rejected and erroneous signaling dialogs as well as additional background information for more complex features. 

| Feature Name                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Relation to Other Features                    | Link to Additional Information  | TNSM Paper |
|----------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|---------------------------------|---------------|
| simId                                  | Unique, pseudonymized identifier per device. Consistent across both GTP and MAP signaling messages.                                                                                                                                                                                                                                                                                                                                                                        |                                               | [ANONYMIZATION](#anonymization) |               |
| Overall Statistics                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 |               |
| n                                      | Absolute number of observed signaling dialogs across both MAP and GTP protocols. These include all types of signaling messages as well as all successful, erroneous and rejected dialogs. Finally, a small fraction of messages has not been classified for this work and is hence subsumed as "other" messages, which are also included here.                                                                                                                             |                                               | [DIALOG](#dialog)               | 1             |
| n_success                              | Absolute number of observed signaling dialogs with successful outcome. This includes successful dialogs with explicit success op-codes as well as contextually valid dialogs without explicit success op-codes.                                                                                                                                                                                                                                                            | n_success < n                                 | [SUCCESS](#success)             |               |
| n_errors                               | Absolute number of erroneous signaling dialogs. This includes technical errors like incomplete dialogs, out of orderMSUs or invalid messages.                                                                                                                                                                                                                                                                                                                              | n_errors < n                                  | [ERROR](#error)                 |               |
| n_rejects                              | Absolute number of rejected dialogs. These include actively rejected requests that indicate some form of refusal by the home network to process the request. This includes technically successful messages that result in one of the following responses by the home network: RoamingNotAllowed, UnknownSubscriber, InvalidDataValue. Other rejection messages do happen occasionally, but these three make up the majority of rejects observed in either of the datasets. | n_rejects < n                                 | [REJECT](#reject)               |               |
| n_unknown                              | Absolute number of unknown dialogs. These include dialogs that are not one of the following message types: SAI, UL, UL_GPRS, CL, PDP_CREATE, PDP_UDATE, PDP_DELETE.                                                                                                                                                                                                                                                                                                        | n_unknown < n                                 | [UNKNOWN](#unknown)             |               |
| n_sigtran                              | Absolute number of observed signaling dialogs of the MAP protocol.                                                                                                                                                                                                                                                                                                                                                                                                         | n_sigtran < n                                 |                                 |               |
| n_gtp                                  | Absolute number of observed signaling dialogs of the GTP protocol.                                                                                                                                                                                                                                                                                                                                                                                                         | n_gtp < n                                     |                                 |               |
| pct_sigtran                            | Percentage of observed signaling dialogs attributed to MAP/SIGTRAN traffic                                                                                                                                                                                                                                                                                                                                                                                                 | n_sigtran / n                                 |                                 | 1             |
| pct_gtp                                | Percentage of observed signaling dialogs attributed to GTP traffic                                                                                                                                                                                                                                                                                                                                                                                                         | n_gtp / n                                     |                                 | 1             |
| pct_success                            | Percentage of observed dialogs that are classified as successful                                                                                                                                                                                                                                                                                                                                                                                                           | n_success / n                                 | [SUCCESS](#success)             | 1             |
| pct_errors                             | Percentage of observed dialogs that are classified as errors                                                                                                                                                                                                                                                                                                                                                                                                               | n_errors / n                                  | [ERROR](#error)                 | 1             |
| pct_rejects                            | Percentage of observed dialogs that are classified as rejects                                                                                                                                                                                                                                                                                                                                                                                                              | n_rejects / n                                 | [REJECT](#reject)               | 1             |
| pct_unknown                            | Percentage of observed dialogs that are classified as unknown                                                                                                                                                                                                                                                                                                                                                                                                              | n_unknwon / n                                 | [UNKNOWN](#unknown)             | 1             |
| Device Activity Statistics             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 |               |
| total_activity_in_minutes              | Time in minutes between the first and last dialog of the device as observed in the trace.                                                                                                                                                                                                                                                                                                                                                                                  |                                               |                                 | 1             |
| active_minutes                         | Number of time slots with duration one minute in which at least one dialog has been observed.                                                                                                                                                                                                                                                                                                                                                                              |                                               |                                 | 1             |
| active_pdp_minutes                     | Number of time slots with duration one minute in which an established PDP tunnel did exist.                                                                                                                                                                                                                                                                                                                                                                                |                                               |                                 | 1             |
| relative_activity                      | active_minutes divided by total_activity_in_minutes. The fraction of total time in which the device was actually active.                                                                                                                                                                                                                                                                                                                                                   | active_minutes / total_activity_in_minutes    |                                 | 1             |
| relative_pdp_activity                  | active_pdp_minutes divided by total_activity_in_minutes. The fraction of time at which a PDP tunnel did exist.                                                                                                                                                                                                                                                                                                                                                             | active_pdp_minutes / total_activity_in_minute |                                 | 1             |
| Message Type Statistics                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 |               |
| n_sai                                  | Absolute number of observed sendAuthenticationInfo (SAI) dialogs. This includes successful, erroneous and rejected SAI dialogs. SAI is only used in MAP/SIGTRAN.                                                                                                                                                                                                                                                                                                           | n_sai < n                                     |                                 |               |
| n_ul                                   | Absolute number of observed updateLocation (UL) dialogs. This includes successful, erroneous and rejected UL dialogs. UL is only used in MAP/SIGTRAN.                                                                                                                                                                                                                                                                                                                      | n_ul < n                                      |                                 |               |
| n_ul_gprs                              | Absolute number of observed updateGPRSLocation (UL_GPRS) dialogs. This includes successful, erroneous and rejected UL_GPRS dialogs. UL_GPRS is only used in MAP/SIGTRAN.                                                                                                                                                                                                                                                                                                   | n_ul_gprs < n                                 |                                 |               |
| n_cl                                   | Absolute number of observed cancelLocation (CL) dialogs. This includes successful, erroneous and rejected CL dialogs. CL is only used in MAP/SIGTRAN.                                                                                                                                                                                                                                                                                                                      | n_cl < n                                      |                                 |               |
| n_pdp_create                           | Absolute number of observed Create PDP Context (pdp_create) dialogs. This includes successful, erroneous and rejected pdp_create dialogs. pdp_create is only used in GTP.                                                                                                                                                                                                                                                                                                  | n_pdp_create < n                              |                                 |               |
| n_pdp_update                           | Absolute number of observed Update PDP Context (pdp_update) dialogs. This includes successful, erroneous and rejected pdp_update dialogs. pdp_update is only used in GTP.                                                                                                                                                                                                                                                                                                  | n_pdp_update < n                              |                                 |               |
| n_pdp_delete                           | Absolute number of observed Delete PDP Context (pdp_delete) dialogs. This includes successful, erroneous and rejected pdp_delete dialogs. pdp_delete is only used in GTP.                                                                                                                                                                                                                                                                                                  | n_pdp_delete < n                              |                                 |               |
| n_sai_success                          | Absolute number of observed SAI dialogs that are identified as completed successfully.                                                                                                                                                                                                                                                                                                                                                                                     | n_sai_success < n_sai < n                     | [SUCCESS](#success)             |               |
| n_sai_error                            | Absolute number of observed SAI dialogs that are identified as technically erroneous.                                                                                                                                                                                                                                                                                                                                                                                      | n_sai_error < n_sai < n                       | [ERROR](#error)                 |               |
| n_sai_reject                           | Absolute number of observed SAI dialogs that are identified as rejected.                                                                                                                                                                                                                                                                                                                                                                                                   | n_sai_reject < n_sai < n                      | [REJECT](#reject)               |               |
| n_sai_vlr                              | Absolute number of SAI dialogs originating from the visited network VLR.                                                                                                                                                                                                                                                                                                                                                                                                   | n_sai_vlr < n_sai < n                         |                                 |               |
| n_sai_sgsn                             | Absolute number of SAI dialogs originating from the visited network SGSN.                                                                                                                                                                                                                                                                                                                                                                                                  | n_sai_sgsn < n_sai < n                        |                                 |               |
| n_sai_success_vlr                      | Absolute number of observed SAI dialogs that are identified as completed successfully including only SAI dialogs originating from the visited network VLR.                                                                                                                                                                                                                                                                                                                 | n_sai_succes_vlr < n_sai_vlr < n_sai < n      | [SUCCESS](#success)             |               |
| n_sai_error_vlr                        | Absolute number of observed SAI dialogs that are identified as technically erroneous including only SAI dialogs originating from the visited network VLR.                                                                                                                                                                                                                                                                                                                  | n_sai_error_vlr < n_sai_vlr < n_sai < n       | [ERROR](#error)                 |               |
| n_sai_reject_vlr                       | Absolute number of observed SAI dialogs that are identified as rejected including only SAI dialogs originating from the visited network VLR.                                                                                                                                                                                                                                                                                                                               | n_sai_reject_vlr < n_sai_vlr < n_sai < n      | [REJECT](#reject)               |               |
| n_sai_success_sgsn                     | Absolute number of observed SAI dialogs that are identified as completed successfully including only SAI dialogs originating from the visited network SGSN.                                                                                                                                                                                                                                                                                                                | n_sai_succes_sgsn < n_sai_sgsn < n_sai < n    | [SUCCESS](#success)             |               |
| n_sai_error_sgsn                       | Absolute number of observed SAI dialogs that are identified as technically erroneous including only SAI dialogs originating from the visited network SGSN.                                                                                                                                                                                                                                                                                                                 | n_sai_error_sgsn < n_sai_sgsn < n_sai < n     | [ERROR](#error)                 |               |
| n_sai_reject_sgsn                      | Absolute number of observed SAI dialogs that are identified as rejected including only SAI dialogs originating from the visited network SGSN.                                                                                                                                                                                                                                                                                                                              | n_sai_reject_sgsn < n_sai_sgsn < n_sai < n    | [REJECT](#reject)               |               |
| n_ul_success                           | n_ul_XYZ features follow the same naming scheme as the n_sai_XYZ features before and are hence not described separately. UL dialogs can only originate from the VLR and are thus not further dissected.                                                                                                                                                                                                                                                                    | n_ul_success < n_ul < n                       | [SUCCESS](#success)             |               |
| n_ul_error                             | cf. n_ul_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_ul_error < n_ul < n                         | [ERROR](#error)                 |               |
| n_ul_reject                            | cf. n_ul_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_ul_reject < n_ul < n                        | [REJECT](#reject)               |               |
| n_ul_gprs_success                      | n_ul_gprs_XYZ features follow the same naming scheme as the n_sai_XYZ features before and are hence not described separately. UL_GPRS dialogs can only originate from the SGSN and are thus not further dissected.                                                                                                                                                                                                                                                         | n_ul_gprs_success < n_ul < n                  | [SUCCESS](#success)             |               |
| n_ul_gprs_error                        | cf. n_ul_gprs_success                                                                                                                                                                                                                                                                                                                                                                                                                                                      | n_ul_gprs_error < n_ul < n                    | [ERROR](#error)                 |               |
| n_ul_gprs_reject                       | cf. n_ul_gprs_success                                                                                                                                                                                                                                                                                                                                                                                                                                                      | n_ul_gprs_reject < n_ul < n                   | [REJECT](#reject)               |               |
| n_cl_success                           | n_cl_XYZ features follow the same naming scheme as the n_sai_XYZ features before and are hence not described separately.                                                                                                                                                                                                                                                                                                                                                   | n_cl_success < n_cl < n                       | [SUCCESS](#success)             |               |
| n_cl_error                             | cf. n_cl_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_cl_error < n_cl < n                         | [ERROR](#error)                 |               |
| n_cl_vlr                               | cf. n_cl_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_cl_vlr < n_cl < n                           |                                 |               |
| n_cl_sgsn                              | cf. n_cl_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_cl_sgsn < n_cl < n                          |                                 |               |
| n_cl_success_vlr                       | cf. n_cl_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_cl_success_vlr < n_cl < n                   | [SUCCESS](#success)             |               |
| n_cl_error_vlr                         | cf. n_cl_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_cl_error_vlr < n_cl_vlr < n_cl < n          | [ERROR](#error)                 |               |
| n_cl_success_sgsn                      | cf. n_cl_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_cl_success_sgsn < n_cl_sgsn < n_cl < n      | [SUCCESS](#success)             |               |
| n_cl_error_sgsn                        | cf. n_cl_success                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n_cl_error_sgsn < n_cl_sgsn < n_cl < n        | [ERROR](#error)                 |               |
| n_pdp_create_success                   | GTP dialogs features follow a similar naming scheme than MAP/SIGTRAN dialogs.                                                                                                                                                                                                                                                                                                                                                                                              | n_pdp_create_success < n_pdp_create < n       | [SUCCESS](#success)             |               |
| n_pdp_create_error                     | cf. n_pdp_create_success                                                                                                                                                                                                                                                                                                                                                                                                                                                   | n_pdp_create_error < n_pdp_create < n         | [ERROR](#error)                 |               |
| n_pdp_update_success                   | cf. n_pdp_create_success                                                                                                                                                                                                                                                                                                                                                                                                                                                   | n_pdp_update_success < n_pdp_update < n       | [SUCCESS](#success)             |               |
| n_pdp_update_error                     | cf. n_pdp_create_success                                                                                                                                                                                                                                                                                                                                                                                                                                                   | n_pdp_update_error < n_pdp_update < n         | [ERROR](#error)                 |               |
| n_pdp_delete_success                   | cf. n_pdp_create_success                                                                                                                                                                                                                                                                                                                                                                                                                                                   | n_pdp_delete_success < n_pdp_delete < n       | [SUCCESS](#success)             |               |
| n_pdp_delete_error                     | cf. n_pdp_create_success                                                                                                                                                                                                                                                                                                                                                                                                                                                   | n_pdp_delete_error < n_pdp_delete < n         | [ERROR](#error)                 |               |
| n_other                                | Number of unclassified dialogs                                                                                                                                                                                                                                                                                                                                                                                                                                             | n_other < n                                   | [UNKNOWN](#unknown)             |               |
| pct_sai_all_dialogs                    | Fraction of SAIs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                          | n_sai / n                                     |                                 | 1             |
| pct_sai_vlr_all_dialogs                | Fraction of SAIs from the VLR among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                             | n_sai_vlr / n                                 |                                 | 1             |
| pct_sai_sgsn_all_dialogs               | Fraction of SAIs from the SGSN among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                            | n_sai_sgsn / n                                |                                 | 1             |
| pct_ul_all_dialogs                     | Fraction of ULs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                           | n_ul / n                                      |                                 | 1             |
| pct_ul_gprs_all_dialogs                | Fraction of UL_GPRS among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                       | n_ul_gprs / n                                 |                                 | 1             |
| pct_cl_all_dialogs                     | Fraction of CLs from the VLR among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                              | n_cl / n                                      |                                 | 1             |
| pct_cl_vlr_all_dialogs                 | Fraction of CLs from the SGSN among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                             | n_cl_vlr / n                                  |                                 | 1             |
| pct_cl_sgsn_all_dialogs                | Fraction of CLs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                           | n_cl_sgsn / n                                 |                                 | 1             |
| pct_pdp_create_all_dialogs             | Fraction of PDP_CREATE among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                    | n_pdp_create / n                              |                                 | 1             |
| pct_pdp_update_all_dialogs             | Fraction of PDP_UPDATE among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                    | n_pdp_update / n                              |                                 | 1             |
| pct_pdp_delete_all_dialogs             | Fraction of PDP_DELETE among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                    | n_pdp_delete / n                              |                                 | 1             |
| pct_other_all_dialogs                  | Fraction of unclassified (other) dialogs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                  | n_other / n                                   |                                 | 1             |
| pct_sai_success_all_sais               | Fraction of successful SAIs among all SAIs (including errors and rejects) of this device                                                                                                                                                                                                                                                                                                                                                                                   | n_sai_success / n_sai                         | [SUCCESS](#success)             | 1             |
| pct_sai_success_all_success            | Fraction of successful SAIs among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                    | n_sai_success / n_success                     | [SUCCESS](#success)             | 1             |
| pct_sai_success_all_dialogs            | Fraction of successful SAIs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                               | n_sai_sucess / n                              | [SUCCESS](#success)             | 1             |
| pct_sai_error_all_sais                 | Fraction of erroneous SAIs among all SAIs (including successful dialogs and rejects) of this device                                                                                                                                                                                                                                                                                                                                                                        | n_sai_error / n_sai                           | [ERROR](#error)                 | 1             |
| pct_sai_error_all_errors               | Fraction of erroneous SAIs among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                      | n_sai_error / n_errors                        | [ERROR](#error)                 | 1             |
| pct_sai_error_all_dialogs              | Fraction of erroneous SAIs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                | n_sai_error / n                               | [ERROR](#error)                 | 1             |
| pct_sai_reject_all_sais                | Fraction of rejected SAIs among all SAIs (including successful dialogs and errors) of this device                                                                                                                                                                                                                                                                                                                                                                          | n_sai_reject / n_sai                          | [REJECT](#reject)               | 1             |
| pct_sai_reject_all_rejects             | Fraction of rejected SAIs among all rejected dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                        | n_sai_reject / n_rejects                      | [REJECT](#reject)               | 1             |
| pct_sai_reject_all_dialogs             | Fraction of rejected SAIs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                 | n_sai_reject / n                              | [REJECT](#reject)               | 1             |
| pct_sai_success_vlr_all_sais           | Fraction of successful SAIs from the VLR among all SAIs (including errors and rejects) of this device                                                                                                                                                                                                                                                                                                                                                                      | n_sai_success_vlr / n_sai                     | [SUCCESS](#success)             | 1             |
| pct_sai_success_vlr_all_success        | Fraction of successful SAIs from the VLR among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                       | n_sai_success_vlr / n_success                 | [SUCCESS](#success)             | 1             |
| pct_sai_success_vlr_all_dialogs        | Fraction of successful SAIs from the VLR among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                  | n_sai_success_vlr / n                         | [SUCCESS](#success)             | 1             |
| pct_sai_error_vlr_all_sais             | Fraction of erroneous SAIs from the VLR among all SAIs (including successful dialogs and rejects) of this device                                                                                                                                                                                                                                                                                                                                                           | n_sai_error_vlr / n_sai                       | [ERROR](#error)                 | 1             |
| pct_sai_error_vlr_all_errors           | Fraction of erroneous SAIs from the VLR among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                         | n_sai_error_vlr / n_errors                    | [ERROR](#error)                 | 1             |
| pct_sai_error_vlr_all_dialogs          | Fraction of erroneous SAIs from the VLR among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                   | n_sai_error_vlr / n                           | [ERROR](#error)                 | 1             |
| pct_sai_reject_vlr_all_sais            | Fraction of rejected SAIs from the VLR among all SAIs (including successful dialogs and errors) of this device                                                                                                                                                                                                                                                                                                                                                             | n_sai_reject_vlr / n_sai                      | [REJECT](#reject)               | 1             |
| pct_sai_reject_vlr_all_rejects         | Fraction of rejected SAIs from the VLR among all rejected dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                           | n_sai_reject_vlr / n_rejects                  | [REJECT](#reject)               | 1             |
| pct_sai_reject_vlr_all_dialogs         | Fraction of rejected SAIs from the VLR among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                    | n_sai_reject_vlr / n                          | [REJECT](#reject)               | 1             |
| pct_sai_success_sgsn_all_sais          | Fraction of successful SAIs from the SGSN among all SAIs (including errors and rejects) of this device                                                                                                                                                                                                                                                                                                                                                                     | n_sai_success_sgsn / n_sai                    | [SUCCESS](#success)             | 1             |
| pct_sai_success_sgsn_all_success       | Fraction of successful SAIs from the SGSN among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                      | n_sai_success_sgsn / n_success                | [SUCCESS](#success)             | 1             |
| pct_sai_success_sgsn_all_dialogs       | Fraction of successful SAIs from the SGSN among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                 | n_sai_success_sgsn / n                        | [SUCCESS](#success)             | 1             |
| pct_sai_error_sgsn_all_sais            | Fraction of erroneous SAIs from the SGSN among all SAIs (including successful dialogs and rejects) of this device                                                                                                                                                                                                                                                                                                                                                          | n_sai_error_sgsn / n_sai                      | [ERROR](#error)                 | 1             |
| pct_sai_error_sgsn_all_errors          | Fraction of erroneous SAIs from the SGSN among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                        | n_sai_error_sgsn / n_errors                   | [ERROR](#error)                 | 1             |
| pct_sai_error_sgsn_all_dialogs         | Fraction of erroneous SAIs from the SGSN among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                  | n_sai_error_sgsn / n                          | [ERROR](#error)                 | 1             |
| pct_sai_reject_sgsn_all_sais           | Fraction of rejected SAIs from the SGSN among all SAIs (including successful dialogs and errors) of this device                                                                                                                                                                                                                                                                                                                                                            | n_sai_reject_sgsn / n_sai                     | [REJECT](#reject)               | 1             |
| pct_sai_reject_sgsn_all_rejects        | Fraction of rejected SAIs from the SGSN among all rejected dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                          | n_sai_reject_sgsn / n_rejects                 | [REJECT](#reject)               | 1             |
| pct_sai_reject_sgsn_all_dialogs        | Fraction of rejected SAIs from the SGSN among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                   | n_sai_reject_sgsn / n                         | [REJECT](#reject)               | 1             |
| pct_ul_success_all_success             | Fraction of successful ULs among all ULs (including errors and rejects) of this device                                                                                                                                                                                                                                                                                                                                                                                     | n_ul_success / n_ul                           | [SUCCESS](#success)             | 1             |
| pct_ul_success_all_uls                 | Fraction of successful ULs among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                     | n_ul_success / n_success                      | [SUCCESS](#success)             | 1             |
| pct_ul_success_all_dialogs             | Fraction of successful ULs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                | n_ul_sucess / n                               | [SUCCESS](#success)             | 1             |
| pct_ul_error_all_uls                   | Fraction of erroneous ULs among all ULs (including successful dialogs and rejects) of this device                                                                                                                                                                                                                                                                                                                                                                          | n_ul_error / n_ul                             | [ERROR](#error)                 | 1             |
| pct_ul_error_all_errors                | Fraction of erroneous ULs among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                       | n_ul_error / n_errors                         | [ERROR](#error)                 | 1             |
| pct_ul_error_all_dialogs               | Fraction of erroneous ULs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                 | n_ul_error / n                                | [ERROR](#error)                 | 1             |
| pct_ul_reject_all_uls                  | Fraction of rejected ULs among all ULs (including successful dialogs and errors) of this device                                                                                                                                                                                                                                                                                                                                                                            | n_ul_reject / n_ul                            | [REJECT](#reject)               | 1             |
| pct_ul_reject_all_rejects              | Fraction of rejected ULs among all rejected dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                         | n_ul_reject / n_rejects                       | [REJECT](#reject)               | 1             |
| pct_ul_reject_all_dialogs              | Fraction of rejected ULs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                  | n_ul_reject / n                               | [REJECT](#reject)               | 1             |
| pct_ul_gprs_success_all_ul_gprs        | Fraction of successful UL_GPRS among all UL_GPRS (including errors and rejects) of this device                                                                                                                                                                                                                                                                                                                                                                             | n_ul_gprs_success / n_ul_gprs                 | [SUCCESS](#success)             | 1             |
| pct_ul_gprs_success_all_success        | Fraction of successful UL_GPRS among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                 | n_ul_gprs_success / n_success                 | [SUCCESS](#success)             | 1             |
| pct_ul_gprs_success_all_dialogs        | Fraction of successful UL_GPRS among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                            | n_ul_gprs_sucess / n                          | [SUCCESS](#success)             | 1             |
| pct_ul_gprs_error_all_ul_gprs          | Fraction of erroneous UL_GPRS among all UL_GPRS (including successful dialogs and rejects) of this device                                                                                                                                                                                                                                                                                                                                                                  | n_ul_gprs_error / n_ul_gprs                   | [ERROR](#error)                 | 1             |
| pct_ul_gprs_error_all_errors           | Fraction of erroneous UL_GPRS among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                   | n_ul_gprs_error / n_errors                    | [ERROR](#error)                 | 1             |
| pct_ul_gprs_error_all_dialogs          | Fraction of erroneous UL_GPRS among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                             | n_ul_gprs_error / n                           | [ERROR](#error)                 | 1             |
| pct_ul_gprs_reject_all_ul_gprs         | Fraction of rejected UL_GPRS among all UL_GPRS (including successful dialogs and errors) of this device                                                                                                                                                                                                                                                                                                                                                                    | n_ul_gprs_reject / n_ul_gprs                  | [REJECT](#reject)               | 1             |
| pct_ul_gprs_reject_all_rejects         | Fraction of rejected UL_GPRS among all rejected dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                     | n_ul_gprs_reject / n_rejects                  | [REJECT](#reject)               | 1             |
| pct_ul_gprs_reject_all_dialogs         | Fraction of rejected UL_GPRS among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                              | n_ul_gprs_reject / n                          | [REJECT](#reject)               | 1             |
| pct_cl_success_all_cls                 | Fraction of successful CLs among all CLs (including errors) of this device                                                                                                                                                                                                                                                                                                                                                                                                 | n_cl_success / n_cl                           | [SUCCESS](#success)             | 1             |
| pct_cl_success_all_success             | Fraction of successful CLs among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                     | n_cl_success / n_success                      | [SUCCESS](#success)             | 1             |
| pct_cl_success_all_dialogs             | Fraction of successful CLs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                | n_cl_sucess / n                               | [SUCCESS](#success)             | 1             |
| pct_cl_error_all_cls                   | Fraction of erroneous CLs among all CLs (including successful dialogs) of this device                                                                                                                                                                                                                                                                                                                                                                                      | n_cl_error / n_cl                             | [ERROR](#error)                 | 1             |
| pct_cl_error_all_errors                | Fraction of erroneous CLs among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                       | n_cl_error / n_errors                         | [ERROR](#error)                 | 1             |
| pct_cl_error_all_dialogs               | Fraction of erroneous CLs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                                 | n_cl_error / n                                | [ERROR](#error)                 | 1             |
| pct_cl_success_vlr_all_cls             | Fraction of successful CLs from the VLR among all CLs (including errors) of this device                                                                                                                                                                                                                                                                                                                                                                                    | n_cl_success_vlr / n_cl                       | [SUCCESS](#success)             | 1             |
| pct_cl_success_vlr_all_success         | Fraction of successful CLs from the VLR among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                        | n_cl_success_vlr / n_success                  | [SUCCESS](#success)             | 1             |
| pct_cl_success_vlr_all_dialogs         | Fraction of successful CLs from the VLR among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                   | n_cl_success_vlr / n                          | [SUCCESS](#success)             | 1             |
| pct_cl_error_vlr_all_cls               | Fraction of erroneous CLs from the VLR among all CLs (including successful dialogs) of this device                                                                                                                                                                                                                                                                                                                                                                         | n_cl_error_vlr / n_cl                         | [ERROR](#error)                 | 1             |
| pct_cl_error_vlr_all_errors            | Fraction of erroneous CLs from the VLR among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                          | n_cl_error_vlr / n_errors                     | [ERROR](#error)                 | 1             |
| pct_cl_error_vlr_all_dialogs           | Fraction of erroneous CLs from the VLR among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                    | n_cl_error_vlr / n                            | [ERROR](#error)                 | 1             |
| pct_cl_success_sgsn_all_cls            | Fraction of successful CLs from the SGSN among all CLs (including errors) of this device                                                                                                                                                                                                                                                                                                                                                                                   | n_cl_success_sgsn / n_cl                      | [SUCCESS](#success)             | 1             |
| pct_cl_success_sgsn_all_success        | Fraction of successful CLs from the SGSN among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                       | n_cl_success_sgsn / n_success                 | [SUCCESS](#success)             | 1             |
| pct_cl_success_sgsn_all_dialogs        | Fraction of successful CLs from the SGSN among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                  | n_cl_success_sgsn / n                         | [SUCCESS](#success)             | 1             |
| pct_cl_error_sgsn_all_cls              | Fraction of erroneous CLs from the SGSN among all CLs (including successful dialogs) of this device                                                                                                                                                                                                                                                                                                                                                                        | n_cl_error_sgsn / n_cl                        | [ERROR](#error)                 | 1             |
| pct_cl_error_sgsn_all_errors           | Fraction of erroneous CLs from the SGSN among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                         | n_cl_error_sgsn / n_errors                    | [ERROR](#error)                 | 1             |
| pct_cl_error_sgsn_all_dialogs          | Fraction of erroneous CLs from the SGSN among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                   | n_cl_error_sgsn / n                           | [ERROR](#error)                 | 1             |
| pct_pdp_create_success_all_pdp_creates | Fraction of successful PDP_CREATEs among all PDP_CREATEs (including errors) of this device                                                                                                                                                                                                                                                                                                                                                                                 | n_pdp_create_success / n_pdp_create           | [SUCCESS](#success)             | 1             |
| pct_pdp_create_success_all_success     | Fraction of successful PDP_CREATEs among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                             | n_pdp_create_success / n_success              | [SUCCESS](#success)             | 1             |
| pct_pdp_create_success_all_dialogs     | Fraction of successful PDP_CREATEs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                        | n_pdp_create_sucess / n                       | [SUCCESS](#success)             | 1             |
| pct_pdp_create_error_all_pdp_creates   | Fraction of erroneous PDP_CREATEs among all PDP_CREATEs (including successful dialogs) of this device                                                                                                                                                                                                                                                                                                                                                                      | n_pdp_create_error / n_pdp_create             | [ERROR](#error)                 | 1             |
| pct_pdp_create_error_all_errors        | Fraction of erroneous PDP_CREATEs among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                               | n_pdp_create_error / n_errors                 | [ERROR](#error)                 | 1             |
| pct_pdp_create_error_all_dialogs       | Fraction of erroneous PDP_CREATEs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                         | n_pdp_create_error / n                        | [ERROR](#error)                 | 1             |
| pct_pdp_update_success_all_pdp_updates | Fraction of successful PDP_UPDATEs among all PDP_UPDATEs (including errors) of this device                                                                                                                                                                                                                                                                                                                                                                                 | n_pdp_update_success / n_pdp_update           | [SUCCESS](#success)             | 1             |
| pct_pdp_update_success_all_success     | Fraction of successful PDP_UPDATEs among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                             | n_pdp_update_success / n_success              | [SUCCESS](#success)             | 1             |
| pct_pdp_update_success_all_dialogs     | Fraction of successful PDP_UPDATEs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                        | n_pdp_update_sucess / n                       | [SUCCESS](#success)             | 1             |
| pct_pdp_update_error_all_pdp_updates   | Fraction of erroneous PDP_UPDATEs among all PDP_UPDATEs (including successful dialogs) of this device                                                                                                                                                                                                                                                                                                                                                                      | n_pdp_update_error / n_pdp_update             | [ERROR](#error)                 | 1             |
| pct_pdp_update_error_all_errors        | Fraction of erroneous PDP_UPDATEs among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                               | n_pdp_update_error / n_errors                 | [ERROR](#error)                 | 1             |
| pct_pdp_update_error_all_dialogs       | Fraction of erroneous PDP_UPDATEs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                         | n_pdp_update_error / n                        | [ERROR](#error)                 | 1             |
| pct_pdp_delete_success_all_pdp_deletes | Fraction of successful PDP_DELETEs among all PDP_DELETEs (including errors) of this device                                                                                                                                                                                                                                                                                                                                                                                 | n_pdp_delete_success / n_pdp_delete           | [SUCCESS](#success)             | 1             |
| pct_pdp_delete_success_all_success     | Fraction of successful PDP_DELETEs among all successful dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                             | n_pdp_delete_success / n_success              | [SUCCESS](#success)             | 1             |
| pct_pdp_delete_success_all_dialogs     | Fraction of successful PDP_DELETEs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                        | n_pdp_delete_sucess / n                       | [SUCCESS](#success)             | 1             |
| pct_pdp_delete_error_all_pdp_deletes   | Fraction of erroneous PDP_DELETEs among all PDP_DELETEs (including successful dialogs) of this device                                                                                                                                                                                                                                                                                                                                                                      | n_pdp_delete_error / n_pdp_delete             | [ERROR](#error)                 | 1             |
| pct_pdp_delete_error_all_errors        | Fraction of erroneous PDP_DELETEs among all erroneous dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                               | n_pdp_delete_error / n_errors                 | [ERROR](#error)                 | 1             |
| pct_pdp_delete_error_all_dialogs       | Fraction of erroneous PDP_DELETEs among all dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                         | n_pdp_delete_error / n                        | [ERROR](#error)                 | 1             |
| pct_other_all_unknowns                 | Fraction of other dialogs among all unkown dialogs of this device                                                                                                                                                                                                                                                                                                                                                                                                          | n_other / n_unknown                           | [UNKNOWN](#unknown)             | 1             |
| n_contexts_total                       | Total number of GTP tunnels                                                                                                                                                                                                                                                                                                                                                                                                                                                | n_contexts_total < n                          |                                 | 1             |
| n_contexts_valid                       | Total number of valid GTP tunnels. A context is considered valid, if it contains exactly one PDP_CREATE and exactly one PDP_DELETE as well as an arbitrary number of PDP_UPDATEs.                                                                                                                                                                                                                                                                                          | n_contexts_valid <= n_contexts_total          |                                 | 1             |
| pct_contexts_valid                     | Fraction of GTP tunnels considered valid                                                                                                                                                                                                                                                                                                                                                                                                                                   | n_contexts_valid / n_contexts_total           |                                 | 1             |
| Session Statistics                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 |               |
| n_sessions                             | Number of detected sessions.                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                               | [SESSION](#session)             |               |
| pct_sessions_with_sai                  | Fraction of sessions containing at least one SAI                                                                                                                                                                                                                                                                                                                                                                                                                           |                                               | [SESSION](#session)             | 1             |
| pct_sessions_with_pdp                  | Fraction of sessions containing a valid GTP tunnel                                                                                                                                                                                                                                                                                                                                                                                                                         |                                               | [SESSION](#session)             | 1             |
| pct_sessions_without_pdp               | Fraction of sessions containing no GTP tunnel                                                                                                                                                                                                                                                                                                                                                                                                                              |                                               | [SESSION](#session)             | 1             |
| top_90pct_sessions                     | Number of different sessions making up 90% of all sessions                                                                                                                                                                                                                                                                                                                                                                                                                 |                                               | [SESSION](#session)             | 1             |
| top_99pct_sessions                     | Number of different sessions making up 99% of all sessions                                                                                                                                                                                                                                                                                                                                                                                                                 |                                               | [SESSION](#session)             | 1             |
| mean_number_of_messages_per_session    | Mean number of messages per sessions                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                               | [SESSION](#session)             | 1             |
| pct_of_sais_alone                      | Fraction of SAIs that stand alone, without any surrounding dialogs.                                                                                                                                                                                                                                                                                                                                                                                                        |                                               |                                 | 1             |
| Device Information                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 |               |
| gsma.model_name                        | Model name based on TAC database                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                               |                                 |               |
| gsma.brand_name                        | Brand name based on TAC database                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                               |                                 |               |
| gsma.marketing_name                    | Marketing name based on TAC database                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                               |                                 |               |
| gsma.device_type                       | Device type based on TAC database                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                               |                                 |               |
| gsma.manufacturer                      | Manufacturer based on TAC database                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                               |                                 |               |
| organisationId                         | Identifier of the organisation this device belongs to                                                                                                                                                                                                                                                                                                                                                                                                                      |                                               |                                 |               |
| Mobility Statistics                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 |               |
| n_country_unique                       | Number of unique countries observed for this device                                                                                                                                                                                                                                                                                                                                                                                                                        |                                               |                                 | 1             |
| n_country_valid                        | Number of valid countries observed for this device. A country is valid in this context if an UL or UL_GPRS dialog is observed for this country.                                                                                                                                                                                                                                                                                                                            |                                               |                                 | 1             |
| n_country_changes                      | Number of country changes in total                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                               |                                 | 1             |
| n_operator_unique                      | Number of unique operators observed for this device                                                                                                                                                                                                                                                                                                                                                                                                                        |                                               |                                 | 1             |
| n_operator_valid                       | Number of valid operators observed for this device. An operator is valid in this context if an UL or UL_GPRS dialog is observed for this operator.                                                                                                                                                                                                                                                                                                                         |                                               |                                 | 1             |
| n_operator_changes                     | Number of operator changes in total                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                               |                                 | 1             |
| n_ci_unique                            | Number of unique cell IDs observed                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                               |                                 | 1             |
| n_ci_valid                             | Number of valid cells observed for this device. A cell is valid in this context if the messages in context of this cell are part of a valid GTP context. Such a context consits of exactly one PDP_CREATE, one PDP_DELETE and none, one or more PDP_UPDATEs.                                                                                                                                                                                                               |                                               |                                 | 1             |
| n_ci_changes                           | Number of cell changes in total                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 | 1             |
| n_vlr_unique                           | Number of unique VLRs observed                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                               |                                 | 1             |
| n_vlr_valid                            | Number of valid VLRs observed for this device. A VLR is valid in this context if an UL dialog is observed for this VLR.                                                                                                                                                                                                                                                                                                                                                    |                                               |                                 | 1             |
| n_vlr_changes                          | Number of VLR changes in total                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                               |                                 | 1             |
| n_sgsn_unique                          | Number of unique SGSNs observed                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 | 1             |
| n_sgsn_valid                           | Number of valid SGSNs observed for this device. A SGSN is valid in this context if an UL_GPRS dialog is observed for this SGSN.                                                                                                                                                                                                                                                                                                                                            |                                               |                                 | 1             |
| n_sgsn_changes                         | Number of SGSN changes in total                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 | 1             |
| Longitudinal Activity Statistics       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                               |                                 |               |
| mean_context_duration                  | The mean duration of GTP tunnel between PDP_CREATE and PDP_DELETE                                                                                                                                                                                                                                                                                                                                                                                                          |                                               |                                 | 1             |
| sd_context_duration                    | The standard deviation of GTP tunnel duration                                                                                                                                                                                                                                                                                                                                                                                                                              |                                               |                                 | 1             |
| mean_dt_update                         | Interarrival time before each PDP_UPDATE. This includes interarrival times between subsequent PDP_UPDATES as well as the PDP_CREATE and the first PDP_UPDATE.                                                                                                                                                                                                                                                                                                              |                                               |                                 | 1             |
| sd_dt_update                           | Standard deviation of this interarrival time                                                                                                                                                                                                                                                                                                                                                                                                                               |                                               |                                 | 1             |
| mean_iat_in_session                    | Mean interarrival time within identified sessions.                                                                                                                                                                                                                                                                                                                                                                                                                         |                                               |                                 | 1             |
| sd_iat_in_session                      | Standard deviation of interarrival times within identified sessions.                                                                                                                                                                                                                                                                                                                                                                                                       |                                               |                                 | 1             |
| mean_session_iat                       | Mean interarrival time between sessions                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                               |                                 | 1             |
| sd_session_iat                         | Standard deviation of interarrival times between sessions                                                                                                                                                                                                                                                                                                                                                                                                                  |                                               |                                 | 1             |
| mean_session_iat_pdp                   | Mean interarrival time between sessions that include GTP tunnels                                                                                                                                                                                                                                                                                                                                                                                                           |                                               |                                 | 1             |
| sd_session_iat_pdp                     | The corresponding standard deviation                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                               |                                 | 1             |
| mean_session_iat_sig                   | Mean interarrival time between sessions without GTP tunnels, so sessions containing purely SS7/Sigtran dialogs (SAI, UL, UL_GPRS)                                                                                                                                                                                                                                                                                                                                          |                                               |                                 | 1             |
| sd_session_iat_sig                     | The corresponding standard deviation                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                               |                                 | 1             |


# Additional Background Information

## Dialog
<a name="dialog"></a>
In the two datasets analyzed in this work, differentiate and parse seven distinct message types: sendAuthenticationInfo (SAI), updateLocation (UL), updateGPRSLocation (UL\_GPRS), Create PDP Context (PDP\_CREATE), Update PDP Context (PDP\_UPDATE) and Delete PDP Context (PDP\_DELETE).

We define a signaling dialog as the complete construct of all requests and responses involved in a particular signaling interaction.

- **SAI**: SAI request --> SAI response
- **UL**: UL request --> n x (ISD request --> ISD response) --> UL response
- **UL\_GPRS**: UL\_GPRS request --> n x (ISD request --> ISD response) --> UL\_GPRS response 
- **CL**: CL request --> CL response
- **PDP\_CREATE**: Create PDP Context Request --> Create PDP Context Response
- **PDP\_UPDATE**: Update PDP Context Request --> Update PDP Context Response
- **PDP\_DELETE**: Delete PDP Context Request --> Delete PDP Context Response

Note that for both UL and UL\_GPRS, the number of ISD (Insert Subscriber Data) request-response pairs can vary between dialogs, as indicated by the `n x (...)`

## Success
<a name="success"></a>
A dialog is considered succesfull if:
- It is one of the following types: SAI, UL, UL\_GPRS, CL, PDP\_CREATE, PDP\_UPDATE, PDP\_DELETE
- All requests and responses were available and in the correct order
- No [error](#error) or [reject](#reject) occurred

## Reject
<a name="reject"></a>

Rejects are defined as signaling interactions (dialogs) that result in the mobile core actively rejecting a request due to various reasons.

- **UnknownSubscriber** can occur for SAI or an UL\_GPRS dialogs. If the reject occurs for a SAI, the reason is that the IMSI sent with the SAI is unfamiliar to the HLR. Hence, the HLR detects a new subscriber that wants to authenticate but is not authorized to do so. If the reject occurs for an UL\_GPRS message, the device is not allowed to establish data connectivity via the SGSN.
- **RoamingNotAllowed** rejects can occur for UL and UL\_GPRS dialogs. These occur if devices are attempting to roam using a visited network that violates either the policy of the MVNO or the device operator.
- **UnexpectedDataValue** occurs if devices attempt to authenticate using SAI dialogs that contain invalid information.

## Error
<a name="error"></a>

Errors are defined as signaling interactions ([dialogs](#dialog)) that violate the criteria for valid request-response pairs or are otherwise unusable for the core network.

In this work, we differentiate five errors types: APN Access Denied, APN Congestion, \_Incomplete, Abort, and \_InvalidOrder.
- APN Access Denied occurs if devices are not allowed to open a data tunnel to send or receive data due to policy reasons like being beyond the allowed data limit or policy limitations. This error can only occur for PDP\_CREATE dialogs. 
- APN Congestion happens if the GGSN is overloaded. This error can in theory occur for any PDP dialogs, but was only observed for PDP\_CREATE dialogs.
- An Abort is an error provided by the TCAP protocol in case of processing errors at the mobile core. Instead of processing and responding to a request, the core can reply using an abort message and cancel the request. It has been observed for SAI, UL, and UL\_GPRS messages.

The last two errors are not included in the packet information and are not specified by the used protocols. Instead, these are artificially generated error messages. To distinguish them from protocol errors they start with and underscore.
- \_Incomplete occurs when no obvious response to a request is found. That has been observed for every message type except [OTHER](#unknown). 
- \_InvalidOrder occurs when a response is seen before a request. This can happen due to time inconsistencies and has been observed for UL and CL dialogs.


## Unknown / Other
<a name="unknown"></a>

As not all existing signaling message types have been parsed and evaluated in the scope of this work, we subsume all remaining signaling interactions under OTHER and call them unknown dialogs.


## Session
<a name="session"></a>

In addition to mapping requests and responses into [dialogs](#dialog), we assemble multiple dialogs into temporally correlated sessions. Meaning we identify dialogs, that occur in close proximity to each other and likely belong to the same signaling interaction. To this end, we define three simple rules that allow the mapping between dialogs and sessions. A session can explicitly consist of only a single dialog.

1. MAP messages are attached to their successor if the interarrival time $A_S$ is smaller than 30 seconds
2. The PDP\_CREATE, PDP\_UPDATE and PDP\_DELETE messages of GTP sessions always belong to the same session
3. A PDP\_DELETE dialog always terminates the current session

# Summary

Here, we present the full set of features identified to describe the signaling behavior of IoT devices using 2G/3G mobile communication. The feature set has been developed in the context of the *TODO* research project, funded by *TODO*. Following is a list of publications in the context of the development of the feature set.

On questions regarding the features or the session detection please contact <stefan.geissler@uni-wuerzburg.de> or <viktoria.vomhoff@uni-wuerzburg.de>.
If you want to cite this feature set, please include a reference to the original paper.
